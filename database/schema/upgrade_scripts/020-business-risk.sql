-- business_risk table
CREATE TABLE IF NOT EXISTS business_risk (
  id INT NOT NULL,
  name VARCHAR NOT NULL UNIQUE,
  CHECK (NOT empty(name)),
  PRIMARY KEY (id)
) TABLESPACE pg_default;

INSERT INTO business_risk (id, name) VALUES
  (0, 'Not Defined'), (1, 'Low'), (2, 'Medium'), (3, 'High');

ALTER TABLE system_vulnerabilities ADD business_risk_id INT NOT NULL DEFAULT 0;

ALTER TABLE system_vulnerabilities ADD CONSTRAINT business_risk_id FOREIGN KEY (business_risk_id) REFERENCES business_risk (id);

ALTER TABLE system_vulnerabilities ADD business_risk_text TEXT;

GRANT SELECT ON ALL TABLES IN SCHEMA public TO ve_db_user_evaluator;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO ve_db_user_listener;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO ve_db_user_manager;
GRANT SELECT ON ALL TABLES IN SCHEMA public TO ve_db_user_vmaas_sync;
